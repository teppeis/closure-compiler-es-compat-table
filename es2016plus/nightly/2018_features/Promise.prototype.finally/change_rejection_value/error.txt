// 2018 features / Promise.prototype.finally / change rejection value
module.exports = (asyncTestPassed) => {
  var score = 0;
  Promise
    .reject("foobar")
    .finally(function() {
      return Promise.reject("foo");
    })
    .catch(function(result) {
      score += (result === "foo");
      check();
      return Promise.reject("foobar");
    })
    .finally(function() {
      throw new Error('bar');
    })
    .catch(function(result) {
      score += (result.message === "bar");
      check();
    });
  function check() {
    if (score === 2) asyncTestPassed();
  }

};
----------------------------------------------------------
/tmp/faast/affc83cb-e8ca-4052-9729-ae954a4b1174/node_modules/google-closure-compiler-linux/compiler: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.32' not found (required by /tmp/faast/affc83cb-e8ca-4052-9729-ae954a4b1174/node_modules/google-closure-compiler-linux/compiler)
/tmp/faast/affc83cb-e8ca-4052-9729-ae954a4b1174/node_modules/google-closure-compiler-linux/compiler: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by /tmp/faast/affc83cb-e8ca-4052-9729-ae954a4b1174/node_modules/google-closure-compiler-linux/compiler)
